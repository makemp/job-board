<%
  # Set meta tags for job directory page
  set_meta_tags(
    title: "Job Offers Directory - DrillCrew",
    description: "Browse all job offers in our directory. Find drilling, mining and energy sector opportunities.",
    url: job_offers_url
  )
%>

<div class="min-h-screen bg-amber-50">
  <!-- Header -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 bg-amber-100 border-b border-amber-200">
    <div class="text-center">
      <h1 class="text-3xl font-bold text-amber-900 mb-2">Job Offers Directory</h1>
      <p class="text-amber-700">Browse all available job opportunities</p>
    </div>
  </div>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="bg-white rounded-lg shadow-lg">
      <!-- Jobs Count -->
      <div class="px-6 py-4 border-b border-gray-200">
      </div>

      <!-- Job Offers List -->
      <div class="divide-y divide-gray-200">
        <% @job_offers.each do |job_offer| %>
          <div class="px-6 py-4 hover:bg-gray-50 transition-colors duration-200">
            <div class="flex items-center justify-between">
              <div class="flex-1">
                <h3 class="text-lg font-medium text-gray-900 mb-1">
                  <%= link_to job_offer.title, job_offer_path(job_offer),
                      class: "text-amber-600 hover:text-amber-800 hover:underline transition-colors duration-200" %>
                  <% if job_offer.expired? %>
                    <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                      Expired
                    </span>
                  <% end %>
                </h3>

                <div class="flex flex-wrap items-center gap-4 text-sm text-gray-500">
                  <span class="flex items-center">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                    </svg>
                    <%= job_offer.company_name %>
                  </span>

                  <% if job_offer.region.present? %>
                    <span class="flex items-center">
                      <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                      </svg>
                      <%= job_offer.region %>
                      <% if job_offer.subregion.present? %>
                        , <%= job_offer.subregion %>
                      <% end %>
                    </span>
                  <% end %>

                  <% if job_offer.category.present? %>
                    <span class="flex items-center">
                      <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                      </svg>
                      <%= job_offer.category %>
                    </span>
                  <% end %>
                </div>
              </div>

              <div class="ml-4 text-right">
                <p class="text-sm text-gray-500">
                  Posted <%= time_ago_in_words(job_offer.created_at) %> ago
                </p>
                <% if job_offer.expired_on.present? %>
                  <p class="text-xs text-gray-400">
                    <% if job_offer.expired? %>
                      Expired <%= time_ago_in_words(job_offer.expired_on) %> ago
                    <% else %>
                      Expires in <%= time_ago_in_words(job_offer.expired_on) %>
                    <% end %>
                  </p>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
      </div>

      <!-- Pagination -->
      <% if @job_offers.respond_to?(:current_page) %>
        <div class="px-6 py-4 border-t border-gray-200">
          <div class="flex items-center justify-between">
            <div class="text-sm text-gray-700">
              Showing page <%= @job_offers.current_page %> of <%= @job_offers.total_pages %>
            </div>

            <div class="flex items-center space-x-2">
              <% if @job_offers.prev_page %>
                <%= link_to "← Previous", job_offers_path(page: @job_offers.prev_page),
                    class: "px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 hover:text-gray-700 transition-colors duration-200" %>
              <% end %>

              <% page_range = [1, [@job_offers.current_page - 2, 1].max].max..[@job_offers.current_page + 2, @job_offers.total_pages].min %>
              <% page_range.each do |page| %>
                <% if page == @job_offers.current_page %>
                  <span class="px-3 py-2 text-sm font-medium text-white bg-amber-600 border border-amber-600 rounded-md">
                    <%= page %>
                  </span>
                <% else %>
                  <%= link_to page, job_offers_path(page: page),
                      class: "px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 hover:text-gray-700 transition-colors duration-200" %>
                <% end %>
              <% end %>

              <% if @job_offers.next_page %>
                <%= link_to "Next →", job_offers_path(page: @job_offers.next_page),
                    class: "px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 hover:text-gray-700 transition-colors duration-200" %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </main>
</div>
